import{A as e,E as t,M as n,O as r,P as i,T as a,_ as o,a as s,c,f as l,h as u,j as d,k as f,l as p,m,o as h,v as g,x as _}from"./index-i-r9Kjbs.js";import{t as v}from"./LoadingModal-CvAAWrhE.js";var y={class:`flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-10 sm:mb-6`},b={class:`flex flex-col justify-end sm:flex-row gap-3`},x={class:`grid gap-3 justify-items-end`},S={class:`flex items-center gap-2`},C=[`value`],w=[`disabled`],T={__name:`HeaderAndControls`,props:{from:{type:String,default:``},to:{type:String,default:``},selectedTemplate:{type:String,default:``},templates:{type:Array,default:()=>[]},busy:{type:Boolean,default:!1}},emits:[`update:from`,`update:to`,`update:selectedTemplate`,`generateReport`],setup(e,{emit:n}){let o=e,s=n,d=m({get:()=>o.from,set:e=>s(`update:from`,e)}),f=m({get:()=>o.to,set:e=>s(`update:to`,e)}),h=m({get:()=>o.selectedTemplate,set:e=>s(`update:selectedTemplate`,e)});return(n,o)=>(a(),g(`div`,y,[o[6]||=u(`div`,null,[u(`h1`,{class:`text-2xl font-bold text-[color:var(--color-primary)]`},` ðŸ“Š å ±è¡¨ç®¡ç† `),u(`p`,{class:`text-sm text-[color:var(--color-secondary)] mt-1`},` å»ºç«‹ã€æŽ’ç¨‹èˆ‡åŒ¯å‡ºæŠ•è³‡/ç¸¾æ•ˆç›¸é—œçš„å ±è¡¨ã€‚ `)],-1),u(`div`,b,[u(`div`,x,[u(`div`,S,[o[4]||=u(`label`,{class:`text-xs text-[color:var(--color-secondary)]`},` æ—¥æœŸå€é–“ `,-1),r(u(`input`,{type:`date`,"onUpdate:modelValue":o[0]||=e=>d.value=e,class:`px-2 py-1 rounded-md bg-[color:var(--color-card)] border border-[color:var(--color-border)] text-[color:var(--color-text)]`},null,512),[[p,d.value]]),o[5]||=u(`span`,{class:`mx-1 text-sm text-[color:var(--color-secondary)]`},`â€”`,-1),r(u(`input`,{type:`date`,"onUpdate:modelValue":o[1]||=e=>f.value=e,class:`px-2 py-1 rounded-md bg-[color:var(--color-card)] border border-[color:var(--color-border)] text-[color:var(--color-text)]`},null,512),[[p,f.value]])]),r(u(`select`,{"onUpdate:modelValue":o[2]||=e=>h.value=e,class:`px-3 py-1 rounded-md bg-[color:var(--color-card)] border border-[color:var(--color-border)] text-[color:var(--color-text)]`},[(a(!0),g(l,null,t(e.templates,e=>(a(),g(`option`,{key:e.id,value:e.id},i(e.name),9,C))),128))],512),[[c,h.value]])]),u(`button`,{onClick:o[3]||=e=>n.$emit(`generateReport`),disabled:e.busy,class:`px-4 py-2 rounded-lg bg-[color:var(--color-primary)] text-white hover:brightness-95 transition cursor-pointer disabled:opacity-60`},i(e.busy?`ç”¢ç”Ÿä¸­â€¦`:`ç”¢ç”Ÿå ±è¡¨`),9,w)])]))}},E={class:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6`},D={class:`text-sm text-[color:var(--color-secondary)]`},ee={__name:`SummaryCards`,props:{lastReport:{type:Object,default:null},exportCount:{type:Number,default:0},scheduled:{type:Array,default:()=>[]},lastRunTime:{type:String,default:``}},setup(e){let r=e,o=m(()=>[{title:`ä¸Šæ¬¡ç”¢ç”Ÿ`,contentClass:`text-[color:var(--color-primary)]`,content:r.lastReport?.name??`å°šæœªç”¢ç”Ÿ`},{title:`ç´¯è¨ˆç”¢ç”Ÿæ¬¡æ•¸`,contentClass:`text-[color:var(--color-line2)]`,content:r.exportCount??0},{title:`é æŽ’ä»»å‹™`,contentClass:`text-[color:var(--color-line3)]`,content:r.scheduled.length},{title:`æœ€å¾Œé‹è¡Œè€—æ™‚`,contentClass:`text-[color:var(--color-primary)]`,content:Number.isFinite(r.lastRunTime)?r.lastRunTime+` s`:`-`}]);return(e,r)=>(a(),g(`div`,E,[(a(!0),g(l,null,t(o.value,e=>(a(),g(`div`,{key:e.title,class:`card-theme rounded-2xl shadow p-4 text-center`},[u(`h3`,D,i(e.title),1),u(`p`,{class:n([e.contentClass,`text-lg font-bold mt-2`])},i(e.content),3)]))),128))]))}};const O=s(`displayFormat`,()=>{let t=e(`TWD`),n=e(!0),r=e(!1),i=e(0),a=e(2),o=e(void 0),s=m(()=>new Intl.NumberFormat(o.value,{style:`currency`,currency:t.value,useGrouping:n.value,notation:r.value?`compact`:`standard`,minimumFractionDigits:i.value,maximumFractionDigits:i.value})),c=m(()=>new Intl.NumberFormat(o.value,{style:`percent`,minimumFractionDigits:a.value,maximumFractionDigits:a.value}));return{currency:t,useGrouping:n,compact:r,fmtCurrency:e=>Number.isFinite(e)?s.value.format(e):`â€”`,fmtPct:e=>Number.isFinite(e)?c.value.format(e):`â€”`,setCurrency:e=>{t.value=e},setUseGrouping:e=>{n.value=!!e},setCompact:e=>{r.value=!!e},setCurrencyDigits:e=>{i.value=+e},setPctDigits:e=>{a.value=+e}}});var k={class:`lg:col-span-2 card-theme rounded-2xl shadow p-4`},A={class:`flex items-center justify-between mb-3`},j={class:`flex items-center gap-2`},M=[`disabled`],N=[`disabled`],P={class:`border border-[color:var(--color-border)] rounded-lg p-4 min-h-[220px]`},F={class:`mb-4`},I={class:`font-medium text-[color:var(--color-primary)]`},L={class:`text-xs text-[color:var(--color-secondary)] mt-1`},R={class:`grid grid-cols-2 gap-4`},z={class:`p-3 bg-[color:var(--color-card)]`},B={class:`text-lg font-bold text-[color:var(--color-primary)]`},V={class:`p-3 bg-[color:var(--color-card)]`},H={class:`text-lg font-bold text-[color:var(--color-line2)]`},U={class:`mt-4`},W={class:`overflow-auto max-h-40 border border-[color:var(--color-border)] rounded-md`},G={class:`w-full text-sm`},K={class:`px-2 py-2`},q={class:`px-2 py-2 text-right`},J={class:`px-2 py-2 text-right`},Y={key:1,class:`h-full flex items-center justify-center text-[color:var(--color-secondary)] opacity-70`},X={__name:`ReportPreview`,props:{latestGenerated:{type:Object,default:null},downloadCSV:{type:Function,required:!0},downloadPDF:{type:Function,required:!0}},setup(e){let n=O();return(r,o)=>(a(),g(`div`,k,[u(`div`,A,[o[2]||=u(`h3`,{class:`font-medium text-[color:var(--color-primary)]`},`å ±è¡¨é è¦½`,-1),u(`div`,j,[u(`button`,{onClick:o[0]||=t=>e.downloadCSV(e.latestGenerated),disabled:!e.latestGenerated,class:`px-3 py-1 rounded-md border border-[color:var(--color-border)] bg-[color:var(--color-card)] text-sm hover:bg-[color:var(--color-border)] transition disabled:opacity-50 cursor-pointer`},` åŒ¯å‡º CSV `,8,M),u(`button`,{onClick:o[1]||=t=>e.downloadPDF(e.latestGenerated),disabled:!e.latestGenerated,class:`px-3 py-1 rounded-md bg-[color:var(--color-primary)] text-white text-sm hover:brightness-95 transition disabled:opacity-50 cursor-pointer`},` åŒ¯å‡º PDF `,8,N)])]),u(`div`,P,[e.latestGenerated?(a(),g(l,{key:0},[u(`div`,F,[o[3]||=u(`div`,{class:`text-sm text-[color:var(--color-secondary)]`},`å ±è¡¨åç¨±`,-1),u(`div`,I,i(e.latestGenerated.name),1),u(`div`,L,`ç”¢ç”Ÿæ™‚é–“ï¼š`+i(e.latestGenerated.date),1)]),u(`div`,R,[u(`div`,z,[o[4]||=u(`div`,{class:`text-xs text-[color:var(--color-secondary)]`},`ç¸½å¸‚å€¼ï¼ˆå€é–“ï¼‰`,-1),u(`div`,B,i(d(n).fmtCurrency(e.latestGenerated.rows.reduce((e,t)=>e+(t.marketValue||0),0))),1)]),u(`div`,V,[o[5]||=u(`div`,{class:`text-xs text-[color:var(--color-secondary)]`},`ç¸½æç›Š`,-1),u(`div`,H,i(d(n).fmtPct(e.latestGenerated.rows.length?e.latestGenerated.rows.reduce((e,t)=>e+(t.pnlPct||0),0)/e.latestGenerated.rows.length:0)),1)])]),u(`div`,U,[o[7]||=u(`h4`,{class:`text-sm font-medium text-[color:var(--color-secondary)] mb-2`},`æ¨£æœ¬è³‡æ–™ï¼ˆæ‘˜éŒ„ï¼‰`,-1),u(`div`,W,[u(`table`,G,[o[6]||=u(`thead`,{class:`bg-[color:var(--color-card)] sticky top-0`},[u(`tr`,null,[u(`th`,{class:`text-left px-2 py-1 text-[color:var(--color-secondary)]`},`è‚¡ç¥¨ä»£è™Ÿ`),u(`th`,{class:`text-right px-2 py-1 text-[color:var(--color-secondary)]`},`å¸‚å€¼`),u(`th`,{class:`text-right px-2 py-1 text-[color:var(--color-secondary)]`},`æç›Š%`)])],-1),u(`tbody`,null,[(a(!0),g(l,null,t(e.latestGenerated.rows.slice(0,6),e=>(a(),g(`tr`,{key:e.ticker,class:`odd:bg-transparent even:bg-[color:var(--color-border)]/60`},[u(`td`,K,i(e.ticker),1),u(`td`,q,i(d(n).fmtCurrency(e.marketValue)),1),u(`td`,J,i(d(n).fmtPct(e.pnlPct)),1)]))),128))])])])])],64)):(a(),g(`div`,Y,` å°šæœªç”¢ç”Ÿå ±è¡¨ â€” æŒ‰ä¸Šæ–¹ã€Œç”¢ç”Ÿå ±è¡¨ã€é–‹å§‹ã€‚ `))])]))}},Z={class:`card-theme rounded-2xl shadow p-4 space-y-4`},te={class:`space-y-2`},Q={class:`text-sm font-medium`},ne={class:`text-xs text-[color:var(--color-secondary)]`},re={class:`flex items-center gap-2`},ie=[`onClick`],ae=[`onClick`],oe={key:0,class:`text-sm text-[color:var(--color-secondary)]`},se={class:`border-t border-[color:var(--color-border)] pt-4`},ce={class:`space-y-2`},le={key:0,class:`text-sm text-[color:var(--color-secondary)]`},ue={class:`font-medium`},de={class:`text-xs text-[color:var(--color-secondary)]`},fe={class:`flex items-center gap-2`},pe=[`onClick`],$={class:`inline-flex items-center gap-2`},me=[`onUpdate:modelValue`],he={class:`text-xs text-[color:var(--color-secondary)]`},ge={__name:`ExportAndScheduleLists`,props:{recentExports:{type:Array,default:()=>[]},scheduled:{type:Array,default:()=>[]},downloadCSV:{type:Function,required:!0},downloadPDF:{type:Function,required:!0},runNow:{type:Function,required:!0}},setup(e){return(n,s)=>(a(),g(`div`,Z,[u(`div`,null,[s[0]||=u(`h3`,{class:`font-medium mb-2 text-[color:var(--color-primary)]`},`æœ€è¿‘åŒ¯å‡º`,-1),u(`ul`,te,[(a(!0),g(l,null,t(e.recentExports,(t,n)=>(a(),g(`li`,{key:n,class:`flex items-center justify-between p-2 rounded-md hover:bg-[color:var(--color-border)] transition`},[u(`div`,null,[u(`div`,Q,i(t.name),1),u(`div`,ne,i(t.date),1)]),u(`div`,re,[u(`button`,{onClick:n=>e.downloadCSV(t),class:`px-2 py-1 text-xs rounded border border-[color:var(--color-border)] bg-[color:var(--color-card)] cursor-pointer`},`CSV`,8,ie),u(`button`,{onClick:n=>e.downloadPDF(t),class:`px-2 py-1 text-xs rounded bg-[color:var(--color-primary)] text-white cursor-pointer`},`PDF`,8,ae)])]))),128)),e.recentExports.length===0?(a(),g(`li`,oe,`ç›®å‰æ²’æœ‰åŒ¯å‡ºç´€éŒ„`)):o(``,!0)])]),u(`div`,se,[s[1]||=u(`h3`,{class:`font-medium mb-2 text-[color:var(--color-primary)]`},`æŽ’ç¨‹ä»»å‹™`,-1),u(`ul`,ce,[e.scheduled.length===0?(a(),g(`li`,le,`å°šæœªå»ºç«‹æŽ’ç¨‹`)):(a(!0),g(l,{key:1},t(e.scheduled,t=>(a(),g(`li`,{key:t.id,class:`flex items-center justify-between p-2 rounded-md hover:bg-[color:var(--color-border)] transition`},[u(`div`,null,[u(`div`,ue,i(t.name),1),u(`div`,de,`é »çŽ‡ï¼š`+i(t.frequency)+` â€¢ æ¨¡æ¿ï¼š`+i(t.template),1)]),u(`div`,fe,[u(`button`,{onClick:n=>e.runNow(t),class:`px-2 py-1 text-xs rounded border border-[color:var(--color-border)] bg-[color:var(--color-card)] cursor-pointer`},`ç«‹å³åŸ·è¡Œ`,8,pe),u(`label`,$,[r(u(`input`,{type:`checkbox`,"onUpdate:modelValue":e=>t.enabled=e,class:`rounded`},null,8,me),[[h,t.enabled]]),u(`span`,he,i(t.enabled?`å•Ÿç”¨`:`åœç”¨`),1)])])]))),128))])])]))}},_e={class:`card-theme rounded-2xl shadow p-4 mt-6`},ve={class:`flex flex-col md:flex-row md:items-center md:justify-between`},ye={class:`flex items-center gap-2 mb-4`},be={__name:`ReportImport`,props:{onUpload:{type:Function,required:!0},openTemplateEditor:{type:Function,required:!0}},setup(e){return(t,n)=>(a(),g(`div`,_e,[u(`div`,ve,[n[2]||=u(`h3`,{class:`font-medium text-[color:var(--color-primary)] mb-4`},`å ±è¡¨åŒ¯å…¥`,-1),u(`div`,ye,[u(`input`,{type:`file`,onChange:n[0]||=(...t)=>e.onUpload&&e.onUpload(...t),class:`text-sm border border-gray-200`},null,32),u(`button`,{onClick:n[1]||=(...t)=>e.openTemplateEditor&&e.openTemplateEditor(...t),class:`px-3 py-1 rounded-md bg-[color:var(--color-primary)] text-white text-sm cursor-pointer`},`åŒ¯å…¥`)])]),n[3]||=u(`div`,{class:`my-2 text-sm text-[color:var(--color-secondary)]`},` åŒ¯å…¥å¤–éƒ¨ CSV å¯ä»¥å¿«é€Ÿå»ºç«‹å ±è¡¨ä¾†æºè³‡æ–™ã€‚ `,-1)]))}},xe={class:`p-6`},Se={class:`grid grid-cols-1 lg:grid-cols-3 gap-6`},Ce={__name:`Reports`,setup(t){let n=e(!1),r=new Date,i=new Date(new Date(r).setFullYear(r.getFullYear()-1));function o(e){let t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,`0`),r=String(e.getDate()).padStart(2,`0`);return`${t}-${n}-${r}`}let s=e(o(i)),c=e(o(r)),d=[{id:`summary`,name:`Summaryï¼ˆç¸½è¦½ï¼‰`},{id:`positions`,name:`Positionsï¼ˆæŒå€‰æ˜Žç´°ï¼‰`},{id:`trades`,name:`Tradesï¼ˆäº¤æ˜“ç´€éŒ„ï¼‰`},{id:`blank`,name:`Blankï¼ˆç©ºç™½å ±è¡¨ï¼‰`}],p=e(d[0].id),m=e(0),h=e([{name:`Daily Summary 2025-10-10`,date:`2025-10-10 09:12`},{name:`Monthly Positions 2025-09`,date:`2025-09-30 18:01`}]),y=f([{id:`s1`,name:`æ¯æ—¥ 08:00 åŒ¯å‡ºç¸½è¦½`,frequency:`Daily`,template:`Summary`,enabled:!0},{id:`s2`,name:`æ¯æœˆ 1 è™Ÿå ±è¡¨`,frequency:`Monthly`,template:`Positions`,enabled:!1}]),b=e(null),x=e(``),S=e(null);function C(){n.value=!0;let e=new Date,t=d.find(e=>e.id===p.value),r=Array.from({length:20}).map((e,t)=>{let n=Math.round(Math.random()*9e4)+1e4,r=(Math.random()*6-3)/100;return{ticker:[`2330.TW`,`0050.TW`,`00675L`][t%3]+` `+(t+1),marketValue:n,pnlPct:r}}),i={id:`r-${e.getTime()}`,template:t.id,name:`${t.name} ${e.toLocaleString()}`,date:e.toLocaleString(),range:{from:s.value||null,to:c.value||null},rows:r};S.value=i,b.value={name:i.name,date:i.date},h.value.unshift({name:i.name,date:i.date}),h.value.length>8&&h.value.pop(),m.value++,x.value=`${(Math.random()*.5+.05).toFixed(2)}s`,n.value=!1}function w(e){if(!e)return alert(`æ²’æœ‰å¯åŒ¯å‡ºçš„å ±è¡¨`);let t=[];t=e.template===`summary`?[`generatedAt`,`from`,`to`,`totalMarketValue`,`totalPnlPct`,`positionsCount`]:e.template===`positions`?[`ticker`,`marketValue`,`pnlPct`]:e.template===`trades`?[`datetime`,`ticker`,`side`,`qty`,`price`,`fee`,`tax`,`net`]:[...new Set(e.rows.flatMap(e=>Object.keys(e)))];let n=[];n.push(`# name: ${e.name}`),n.push(`# generatedAt: ${new Date(e.date).toISOString()}`),e.range&&n.push(`# range: ${e.range.from||``} ~ ${e.range.to||``}`),n.push(t.join(`,`));for(let r of e.rows)n.push(t.map(e=>r[e]??``).join(`,`));let r=new Blob([n.join(`
`)],{type:`text/csv;charset=utf-8`}),i=document.createElement(`a`);i.href=URL.createObjectURL(r),i.download=`${e.template||`report`}-${Date.now()}.csv`,i.click(),URL.revokeObjectURL(i.href)}function E(e){if(!e)return alert(`æ²’æœ‰å¯åŒ¯å‡ºçš„å ±è¡¨`);alert(`é–‹å§‹ä¸‹è¼‰ PDFï¼š${e.name}`)}function D(e){alert(`æŽ’ç¨‹ç«‹å³åŸ·è¡Œï¼š${e.name}`)}function O(e){let t=e.target.files?.[0];t&&alert(`å·²ä¸Šå‚³æª”æ¡ˆï¼š${t.name}ï¼ˆæ­¤ç‚º demoï¼Œä¸æœƒé€²è¡Œè§£æžï¼‰`)}function k(){alert(`é–‹å•Ÿæ¨¡æ¿ç·¨è¼¯å™¨ï¼ˆdemoï¼‰`)}return(e,t)=>(a(),g(l,null,[_(v,{open:n.value,message:`å ±è¡¨ç”Ÿæˆä¸­`},null,8,[`open`]),u(`div`,xe,[_(T,{from:s.value,"onUpdate:from":t[0]||=e=>s.value=e,to:c.value,"onUpdate:to":t[1]||=e=>c.value=e,selectedTemplate:p.value,"onUpdate:selectedTemplate":t[2]||=e=>p.value=e,templates:d,busy:n.value,onGenerateReport:C},null,8,[`from`,`to`,`selectedTemplate`,`busy`]),_(ee,{lastReport:b.value,exportCount:m.value,scheduled:y,lastRunTime:x.value},null,8,[`lastReport`,`exportCount`,`scheduled`,`lastRunTime`]),u(`div`,Se,[_(X,{latestGenerated:S.value,downloadCSV:w,downloadPDF:E},null,8,[`latestGenerated`]),_(ge,{recentExports:h.value,scheduled:y,downloadCSV:w,downloadPDF:E,runNow:D},null,8,[`recentExports`,`scheduled`])]),_(be,{onUpload:O,openTemplateEditor:k})])],64))}};export{Ce as default};